

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Swirl &mdash; skimage v0.6 docs</title>
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../../dev/_static/docversions.js"></script>
    <link rel="top" title="skimage v0.6 docs" href="../index.html" />
    <link rel="up" title="General examples" href="index.html" />
    <link rel="next" title="Template Matching" href="plot_template.html" />
    <link rel="prev" title="Structural similarity index" href="plot_ssim.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <div class="logo"><a href="http://scikits-image.org">
            <img class="logo" src="../_static/scikits_image_logo_small.png" alt="Logo"/>
          </a></div>
       
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
             
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"> 

  
    <h3>Navigation</h3>
    <p>
    <a href="../index.html">Documentation Home</a>
    </p>
    <p>&nbsp;</p>
  
    <h3>Contents</h3>
    <ul>
<li><a class="reference internal" href="#">Swirl</a><ul>
<li><a class="reference internal" href="#image-warping">Image warping</a></li>
<li><a class="reference internal" href="#performing-a-reverse-mapping">Performing a reverse mapping</a></li>
<li><a class="reference internal" href="#the-swirl-transformation">The swirl transformation</a></li>
</ul>
</li>
</ul>



  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_ssim.html"
                        title="previous chapter">Structural similarity index</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_template.html"
                        title="next chapter">Template Matching</a></p>

  <h3>Version</h3>

    <script type="text/javascript">
      insert_version_links();
    </script>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="swirl">
<span id="example-plot-swirl-py"></span><h1>Swirl<a class="headerlink" href="#swirl" title="Permalink to this headline">¶</a></h1>
<p>Image swirling is a non-linear image deformation that creates a whirlpool
effect.  This example describes the implementation of this transform in
<tt class="docutils literal"><span class="pre">skimage</span></tt>, as well as the underlying warp mechanism.</p>
<div class="section" id="image-warping">
<h2>Image warping<a class="headerlink" href="#image-warping" title="Permalink to this headline">¶</a></h2>
<p>When applying a geometric transformation on an image, we typically make use of
a reverse mapping, i.e., for each pixel in the output image, we compute its
corresponding position in the input.  The reason is that, if we were to do it
the other way around (map each input pixel to its new output position), some
pixels in the output may be left empty.  On the other hand, each output
coordinate has exactly one corresponding location in (or outside) the input
image, and even if that position is non-integer, we may use interpolation to
compute the corresponding image value.</p>
</div>
<div class="section" id="performing-a-reverse-mapping">
<h2>Performing a reverse mapping<a class="headerlink" href="#performing-a-reverse-mapping" title="Permalink to this headline">¶</a></h2>
<p>To perform a geometric warp in <tt class="docutils literal"><span class="pre">skimage</span></tt>, you simply need to provide the
reverse mapping to the <tt class="docutils literal"><span class="pre">skimage.transform.warp</span></tt> function.  E.g., consider the
case where we would like to shift an image 50 pixels to the left.  The reverse
mapping for such a shift would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">shift_left</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">50</span>
    <span class="k">return</span> <span class="n">xy</span>
</pre></div>
</div>
<p>The corresponding call to warp is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">warp</span>
<span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">shift_left</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-swirl-transformation">
<h2>The swirl transformation<a class="headerlink" href="#the-swirl-transformation" title="Permalink to this headline">¶</a></h2>
<p>Consider the coordinate <img class="math" src="../_images/math/adfd9ae8a3fac031d3b8b470a52a709a23d4d6d2.png" alt="(x, y)"/> in the output image.  The reverse
mapping for the swirl transformation first computes, relative to a center
<img class="math" src="../_images/math/d3ea5ae5f5092b7024a8775d282032dc76120c9d.png" alt="(x_0, y_0)"/>, its polar coordinates,</p>
<div class="math">
<p><img src="../_images/math/4228f2acab4ff61af13ae45a7488613edd85f9b6.png" alt="\theta = \arctan(y/x)

\rho = \sqrt{(x - x_0)^2 + (y - y_0)^2}," /></p>
</div><p>and then transforms them according to</p>
<div class="math">
<p><img src="../_images/math/e4dec0eace82131cb99e8a8087bffc34d5295b94.png" alt="r = \ln(2) \, \mathtt{radius} / 5

\phi = \mathtt{rotation}

s = \mathtt{strength}

\theta' = \phi + s \, e^{-\rho / r + \theta}" /></p>
</div><p>where <tt class="docutils literal"><span class="pre">strength</span></tt> is a parameter for the amount of swirl, <tt class="docutils literal"><span class="pre">radius</span></tt> indicates
the swirl extent in pixels, and <tt class="docutils literal"><span class="pre">rotation</span></tt> adds a rotation angle.  The
transformation of <tt class="docutils literal"><span class="pre">radius</span></tt> into <img class="math" src="../_images/math/b55ca7a0aa88ab7d58f4fc035317fdac39b17861.png" alt="r"/> is to ensure that the
transformation decays to <img class="math" src="../_images/math/1542782bde3c79868cb1a7a0e622dc06b31a6b82.png" alt="\approx 1/1000^{\mathsf{th}}"/> within the
specified radius.</p>
<img alt="../_images/plot_swirl_1.png" class="align-center" src="../_images/plot_swirl_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">swirl</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">checkerboard</span><span class="p">()</span>
<span class="n">swirled</span> <span class="o">=</span> <span class="n">swirl</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strength</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">swirled</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Python source code:</strong> <a class="reference download internal" href="../_downloads/plot_swirl.py"><tt class="xref download docutils literal"><span class="pre">download</span></tt></a>
(generated using <tt class="docutils literal"><span class="pre">skimage</span></tt> 0.6)</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="clearer"></div>
    </div>
    </div>

    <div class="footer-wrapper">
      
    <div class="footer">
        &copy; Copyright 2011, the scikits-image team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
    </div>

  </body>
</html>