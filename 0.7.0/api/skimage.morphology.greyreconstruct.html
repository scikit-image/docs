

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Module: morphology.greyreconstruct &mdash; skimage v0.7.0 docs</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../../dev/_static/docversions.js"></script>
    <link rel="top" title="skimage v0.7.0 docs" href="../index.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <div class="logo"><a href="http://scikits-image.org">
            <img class="logo" src="../_static/scikits_image_logo_small.png" alt="Logo"/>
          </a></div>
       
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
             
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"> 

  
    <h3>Navigation</h3>
    <p>
    <a href="../index.html">Documentation Home</a>
    </p>
    <p>&nbsp;</p>
  
    <h3>Contents</h3>
    <ul>
<li><a class="reference internal" href="#">Module: <tt class="docutils literal"><span class="pre">morphology.greyreconstruct</span></tt></a><ul>
<li><a class="reference internal" href="#rank-order">rank_order</a></li>
<li><a class="reference internal" href="#reconstruction">reconstruction</a></li>
</ul>
</li>
</ul>




  <h3>Version</h3>

    <script type="text/javascript">
      insert_version_links();
    </script>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-skimage.morphology.greyreconstruct">
<span id="module-morphology-greyreconstruct"></span><h1>Module: <tt class="xref py py-mod docutils literal"><span class="pre">morphology.greyreconstruct</span></tt><a class="headerlink" href="#module-skimage.morphology.greyreconstruct" title="Permalink to this headline">¶</a></h1>
<p>This morphological reconstruction routine was adapted from CellProfiler, code
licensed under both GPL and BSD licenses.</p>
<p>Website: <a class="reference external" href="http://www.cellprofiler.org">http://www.cellprofiler.org</a>
Copyright (c) 2003-2009 Massachusetts Institute of Technology
Copyright (c) 2009-2011 Broad Institute
All rights reserved.
Original author: Lee Kamentsky</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#skimage.morphology.greyreconstruct.rank_order" title="skimage.morphology.greyreconstruct.rank_order"><tt class="xref py py-obj docutils literal"><span class="pre">skimage.morphology.greyreconstruct.rank_order</span></tt></a>(image)</td>
<td>Return an image of the same shape where each pixel is the index of the pixel value in the ascending order of the unique values of <cite>image</cite>, aka the rank-order value.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#skimage.morphology.greyreconstruct.reconstruction" title="skimage.morphology.greyreconstruct.reconstruction"><tt class="xref py py-obj docutils literal"><span class="pre">skimage.morphology.greyreconstruct.reconstruction</span></tt></a>(...)</td>
<td>Perform a morphological reconstruction of an image.</td>
</tr>
</tbody>
</table>
<div class="section" id="rank-order">
<h2>rank_order<a class="headerlink" href="#rank-order" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="skimage.morphology.greyreconstruct.rank_order">
<tt class="descclassname">skimage.morphology.greyreconstruct.</tt><tt class="descname">rank_order</tt><big>(</big><em>image</em><big>)</big><a class="headerlink" href="#skimage.morphology.greyreconstruct.rank_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an image of the same shape where each pixel is the
index of the pixel value in the ascending order of the unique
values of <cite>image</cite>, aka the rank-order value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>image: ndarray</strong> :</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>labels: ndarray of type np.uint32, of shape image.shape</strong> :</p>
<blockquote>
<div><p>New array where each pixel has the rank-order value of the
corresponding pixel in <cite>image</cite>. Pixel values are between 0 and
n - 1, where n is the number of distinct unique values in
<cite>image</cite>.</p>
</div></blockquote>
<p><strong>original_values: 1-d ndarray</strong> :</p>
<blockquote class="last">
<div><p>Unique original values of <cite>image</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[1, 4, 5],</span>
<span class="go">    [4, 4, 1],</span>
<span class="go">    [5, 1, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rank_order</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(array([[0, 1, 2],</span>
<span class="go">    [1, 1, 0],</span>
<span class="go">    [2, 0, 0]], dtype=uint32), array([1, 4, 5]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rank_order</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(array([0, 1, 2, 1], dtype=uint32), array([-1. ,  2.5,  3.1]))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="reconstruction">
<h2>reconstruction<a class="headerlink" href="#reconstruction" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="skimage.morphology.greyreconstruct.reconstruction">
<tt class="descclassname">skimage.morphology.greyreconstruct.</tt><tt class="descname">reconstruction</tt><big>(</big><em>seed</em>, <em>mask</em>, <em>method='dilation'</em>, <em>selem=None</em>, <em>offset=None</em><big>)</big><a class="headerlink" href="#skimage.morphology.greyreconstruct.reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a morphological reconstruction of an image.</p>
<p>Morphological reconstruction by dilation is similar to basic morphological
dilation: high-intensity values will replace nearby low-intensity values.
The basic dilation operator, however, uses a structuring element to
determine how far a value in the input image can spread. In contrast,
reconstruction uses two images: a &#8220;seed&#8221; image, which specifies the values
that spread, and a &#8220;mask&#8221; image, which gives the maximum allowed value at
each pixel. The mask image, like the structuring element, limits the spread
of high-intensity values. Reconstruction by erosion is simply the inverse:
low-intensity values spread from the seed image and are limited by the mask
image, which represents the minimum allowed value.</p>
<p>Alternatively, you can think of reconstruction as a way to isolate the
connected regions of an image. For dilation, reconstruction connects
regions marked by local maxima in the seed image: neighboring pixels
less-than-or-equal-to those seeds are connected to the seeded region.
Local maxima with values larger than the seed image will get truncated to
the seed value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>seed</strong> : ndarray</p>
<blockquote>
<div><p>The seed image (a.k.a. marker image), which specifies the values that
are dilated or eroded.</p>
</div></blockquote>
<p><strong>mask</strong> : ndarray</p>
<blockquote>
<div><p>The maximum (dilation) / minimum (erosion) allowed value at each pixel.</p>
</div></blockquote>
<p><strong>method</strong> : {&#8216;dilation&#8217;|&#8217;erosion&#8217;}</p>
<blockquote>
<div><p>Perform reconstruction by dilation or erosion. In dilation (or
erosion), the seed image is dilated (or eroded) until limited by the
mask image. For dilation, each seed value must be less than or equal
to the corresponding mask value; for erosion, the reverse is true.</p>
</div></blockquote>
<p><strong>selem</strong> : ndarray</p>
<blockquote>
<div><p>The neighborhood expressed as a 2-D array of 1&#8217;s and 0&#8217;s.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>reconstructed</strong> : ndarray</p>
<blockquote class="last">
<div><p>The result of morphological reconstruction.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The algorithm is taken from <a class="reference internal" href="#r136">[R136]</a>. Applications for greyscale reconstruction
are discussed in <a class="reference internal" href="#r137">[R137]</a> and <a class="reference internal" href="#r138">[R138]</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r136" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R136]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> Robinson, &#8220;Efficient morphological reconstruction: a downhill
filter&#8221;, Pattern Recognition Letters 25 (2004) 1759-1767.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r137" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R137]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Vincent, L., &#8220;Morphological Grayscale Reconstruction in Image
Analysis: Applications and Efficient Algorithms&#8221;, IEEE Transactions
on Image Processing (1993)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r138" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R138]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> Soille, P., &#8220;Morphological Image Analysis: Principles and
Applications&#8221;, Chapter 6, 2nd edition (2003), ISBN 3540429883.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <span class="n">reconstruction</span>
</pre></div>
</div>
<p>First, we create a sinusoidal mask image w/ peaks at middle and ends.
&gt;&gt;&gt; x = np.linspace(0, 4 * np.pi)
&gt;&gt;&gt; y_mask = np.cos(x)</p>
<p>Then, we create a seed image initialized to the minimum mask value (for
reconstruction by dilation, min-intensity values don&#8217;t spread) and add
&#8220;seeds&#8221; to the left and right peak, but at a fraction of peak value (1).
&gt;&gt;&gt; y_seed = y_mask.min() * np.ones_like(x)
&gt;&gt;&gt; y_seed[0] = 0.5
&gt;&gt;&gt; y_seed[-1] = 0
&gt;&gt;&gt; y_rec = reconstruction(y_seed, y_mask)</p>
<p>The reconstructed image (or curve, in this case) is exactly the same as the
mask image, except that the peaks are truncated to 0.5 and 0. The middle
peak disappears completely: Since there were no seed values in this peak
region, its reconstructed value is truncated to the surrounding value (-1).</p>
<p>As a more practical example, we try to extract the bright features of an
image by subtracting a background image created by reconstruction.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">20</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bumps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>To create the background image, set the mask image to the original image,
and the seed image to the original image with an intensity offset, <cite>h</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="n">bumps</span> <span class="o">-</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">background</span> <span class="o">=</span> <span class="n">reconstruction</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">bumps</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting reconstructed image looks exactly like the original image,
but with the peaks of the bumps cut off. Subtracting this reconstructed
image from the original image leaves just the peaks of the bumps</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">hdome</span> <span class="o">=</span> <span class="n">bumps</span> <span class="o">-</span> <span class="n">background</span>
</pre></div>
</div>
<p>This operation is known as the h-dome of the image and leaves features
of height <cite>h</cite> in the subtracted image.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="clearer"></div>
    </div>
    </div>

    <div class="footer-wrapper">
      
    <div class="footer">
        &copy; Copyright 2011, the scikits-image team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    </div>

  </body>
</html>