
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Morphological Filtering &#8212; skimage 0.24.1rc0.dev0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=4340df76" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=a22486ce"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="scikit-image.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/applications/plot_morphology';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scikit-image.org/docs/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimate anisotropy in a 3D microscopy image" href="plot_3d_structure_tensor.html" />
    <link rel="prev" title="Visual image comparison" href="plot_image_comparison.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://scikit-image.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="scikit-image's logo, showing a snake's head overlayed with green and orange"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="scikit-image's logo, showing a snake's head overlayed with green and orange"/>`);</script>
  
  
    <p class="title logo__title">scikit-image</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release_notes/index.html">
    Release notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-image/scikit-image" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/scikit-image/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/api.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release_notes/index.html">
    Release notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../development/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-image/scikit-image" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/scikit-image/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/index.html">Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_3d.html">Datasets with 3 or more spatial dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_scientific.html">Scientific images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_general.html">General-purpose images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_specific.html">Specific images</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numpy_operations/index.html">Operations on NumPy arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_camera_numpy.html">Using simple NumPy operations for manipulating images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_structuring_elements.html">Generate footprints (structuring elements)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_view_as_blocks.html">Block views on images/arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_footprint_decompositions.html">Decompose flat footprints (structuring elements)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../color_exposure/index.html">Manipulating exposure and color channels</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_rgb_to_gray.html">RGB to grayscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_rgb_to_hsv.html">RGB to HSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_histogram_matching.html">Histogram matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_adapt_rgb.html">Adapting gray-scale filters to RGB images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_regional_maxima.html">Filtering regional maxima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_ihc_color_separation.html">Separate colors in immunohistochemical staining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_log_gamma.html">Gamma and log contrast adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_equalize.html">Histogram Equalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_tinting_grayscale_images.html">Tinting gray-scale images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_local_equalize.html">Local Histogram Equalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_adapt_hist_eq_3d.html">3D adaptive histogram equalization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../edges/index.html">Edges and lines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_contours.html">Contour finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_convex_hull.html">Convex Hull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_canny.html">Canny edge detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_marching_cubes.html">Marching Cubes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_active_contours.html">Active Contour Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_ridge_filter.html">Ridge operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_shapes.html">Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_random_shapes.html">Random Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_polygon.html">Approximate and subdivide polygons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_line_hough_transform.html">Straight line Hough transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_circular_elliptical_hough_transform.html">Circular and Elliptical Hough Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_skeleton.html">Skeletonize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_edge_filter.html">Edge operators</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../transform/index.html">Geometrical transformations and registration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_swirl.html">Swirl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_edge_modes.html">Interpolation: Edge Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_rescale.html">Rescale, resize, and downscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_pyramid.html">Build image pyramids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_piecewise_affine.html">Piecewise Affine Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_geometric.html">Using geometric transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_ssim.html">Structural similarity index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_transform_types.html">Types of homographies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_tps_deformation.html">Use thin-plate splines for image warping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_fundamental_matrix.html">Fundamental matrix estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_ransac.html">Robust line model estimation using RANSAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_radon_transform.html">Radon transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_matching.html">Robust matching using RANSAC</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../registration/index.html">Image registration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_register_translation.html">Image Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_masked_register_translation.html">Masked Normalized Cross-Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_opticalflow.html">Registration using optical flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_stitching.html">Assemble images with simple image stitching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_register_rotation.html">Using Polar and Log-Polar Transformations for Registration</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../filters/index.html">Filtering and restoration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_tophat.html">Removing small objects in grayscale images with a top hat filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_hysteresis.html">Hysteresis thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_restoration.html">Image Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_window.html">Using window functions with images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_rank_mean.html">Mean filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_unsharp_mask.html">Unsharp masking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_deconvolution.html">Image Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_blur_effect.html">Estimate strength of blur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_entropy.html">Entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_j_invariant.html">Calibrating Denoisers Using J-Invariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_inpaint.html">Fill in defects with inpainting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_dog.html">Band-pass filtering by Difference of Gaussians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_denoise.html">Denoising a picture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_cycle_spinning.html">Shift-invariant wavelet denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_phase_unwrap.html">Phase Unwrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_nonlocal_means.html">Non-local means denoising for preserving textures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_attribute_operators.html">Attribute operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_denoise_wavelet.html">Wavelet denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_butterworth.html">Butterworth Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_j_invariant_tutorial.html">Full tutorial on calibrating Denoisers Using J-Invariance</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../features_detection/index.html">Detection of features and objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_daisy.html">Dense DAISY feature description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_hog.html">Histogram of Oriented Gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_haar.html">Haar-like feature descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_template.html">Template Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_corner.html">Corner detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_multiblock_local_binary_pattern.html">Multi-Block Local Binary Pattern for texture classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_censure.html">CENSURE feature detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_holes_and_peaks.html">Filling holes and finding peaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_remove_objects.html">Removing objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_blob.html">Blob Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_orb.html">ORB feature detector and binary descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_gabors_from_astronaut.html">Gabors / Primary Visual Cortex “Simple Cells” from an Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_fisher_vector.html">Fisher vector feature encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_brief.html">BRIEF binary descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_sift.html">SIFT feature detector and descriptor extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_glcm.html">GLCM Texture Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_shape_index.html">Shape Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_windowed_histogram.html">Sliding window histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_gabor.html">Gabor filter banks for texture classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_local_binary_pattern.html">Local Binary Pattern for texture classification</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../segmentation/index.html">Segmentation of objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_boundary.html">Region Boundary based Region adjacency graphs (RAGs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_mean_color.html">Region adjacency graph (RAG) Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_ncut.html">Normalized Cut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_compact_watershed.html">Find Regular Segments Using Compact Watershed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_thresholding.html">Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_draw.html">Drawing Region Adjacency Graphs (RAGs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_chan_vese.html">Chan-Vese Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_peak_local_max.html">Finding local maxima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_niblack_sauvola.html">Niblack and Sauvola Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_multiotsu.html">Multi-Otsu Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_mask_slic.html">Apply maskSLIC vs SLIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_random_walker_segmentation.html">Random walker segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_expand_labels.html">Expand segmentation labels without overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_watershed.html">Watershed segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_marked_watershed.html">Markers for watershed transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_label.html">Label image regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_segmentations.html">Comparison of segmentation and superpixel algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_join_segmentations.html">Find the intersection of two segmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag.html">Region Adjacency Graphs (RAGs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_merge.html">Region adjacency graph (RAG) Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_perimeters.html">Measure perimeters with different estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_boundary_merge.html">Hierarchical Merging of Region Boundary RAGs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_extrema.html">Extrema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_regionprops_table.html">Explore and visualize region properties with pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_hausdorff_distance.html">Hausdorff Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_morphsnakes.html">Morphological Snakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_trainable_segmentation.html">Trainable segmentation using local features and random forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_regionprops.html">Measure region properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_floodfill.html">Flood Fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_metrics.html">Evaluating segmentation metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_euler_number.html">Euler number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rolling_ball.html">Use rolling-ball algorithm for estimating background intensity</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Longer examples and demonstrations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_text.html">Render text onto an image</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_face_detection.html">Face detection using a cascade classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_interaction.html">Interact with 3D images (of kidney tissue)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_pixel_graphs.html">Use pixel graphs to find an object’s geodesic center</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_image_comparison.html">Visual image comparison</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Morphological Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_structure_tensor.html">Estimate anisotropy in a 3D microscopy image</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_coins_segmentation.html">Comparing edge-based and region-based segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_human_mitosis.html">Segment human cells (in mitosis)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_colocalization_metrics.html">Colocalization metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_cornea_spot_inpainting.html">Restore spotted cornea image with inpainting</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_thresholding_guide.html">Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_solidification_tracking.html">Track solidification of a metallic alloy</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_fluorescence_nuclear_envelope.html">Measure fluorescence intensity at the nuclear envelope</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_haar_extraction_selection_classification.html">Face classification using Haar-like feature descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_image_processing.html">Explore 3D images (of cells)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_rank_filters.html">Rank filters</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developers/index.html">Examples for developers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developers/plot_threshold_li.html">Li thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/plot_max_tree.html">Max-tree</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Longer examples and demonstrations</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Morphologica...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-applications-plot-morphology-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code. or to run this example in your browser via Binder</p>
</div>
<section class="sphx-glr-example-title" id="morphological-filtering">
<span id="sphx-glr-auto-examples-applications-plot-morphology-py"></span><h1>Morphological Filtering<a class="headerlink" href="#morphological-filtering" title="Link to this heading">#</a></h1>
<p>Morphological image processing is a collection of non-linear operations related
to the shape or morphology of features in an image, such as boundaries,
skeletons, etc. In any given technique, we probe an image with a small shape or
template called a structuring element, which defines the region of interest or
neighborhood around a pixel.</p>
<p>In this document we outline the following basic morphological operations:</p>
<ol class="arabic simple">
<li><p>Erosion</p></li>
<li><p>Dilation</p></li>
<li><p>Opening</p></li>
<li><p>Closing</p></li>
<li><p>White Tophat</p></li>
<li><p>Black Tophat</p></li>
<li><p>Skeletonize</p></li>
<li><p>Convex Hull</p></li>
</ol>
<p>To get started, let’s load an image using <code class="docutils literal notranslate"><span class="pre">io.imread</span></code>. Note that morphology
functions only work on gray-scale or binary images, so we set <code class="docutils literal notranslate"><span class="pre">as_gray=True</span></code>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">skimage.util</span> <span class="kn">import</span> <span class="n">img_as_ubyte</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a> <span class="o">=</span> <span class="n">img_as_ubyte</span><span class="p">(</span><a href="../../api/skimage.data.html#skimage.data.shepp_logan_phantom" title="skimage.data.shepp_logan_phantom" class="sphx-glr-backref-module-skimage-data sphx-glr-backref-type-py-function"><span class="n">data</span><span class="o">.</span><span class="n">shepp_logan_phantom</span></a><span class="p">())</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="matplotlib.axes.Axes.imshow" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="matplotlib.colors.LinearSegmentedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_001.png" srcset="../../_images/sphx_glr_plot_morphology_001.png" alt="plot morphology" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage object at 0x7f6026e930e0&gt;
</pre></div>
</div>
<p>Let’s also define a convenience function for plotting comparisons:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_comparison</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">filtered</span><span class="p">,</span> <span class="n">filter_name</span><span class="p">):</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="matplotlib.colors.LinearSegmentedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.LinearSegmentedColormap.html#matplotlib.colors.LinearSegmentedColormap" title="matplotlib.colors.LinearSegmentedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span></a><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">filter_name</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
<section id="erosion">
<h2>Erosion<a class="headerlink" href="#erosion" title="Link to this heading">#</a></h2>
<p>Morphological <code class="docutils literal notranslate"><span class="pre">erosion</span></code> sets a pixel at (i, j) to the <em>minimum over all
pixels in the neighborhood centered at (i, j)</em>. The structuring element,
<code class="docutils literal notranslate"><span class="pre">footprint</span></code>, passed to <code class="docutils literal notranslate"><span class="pre">erosion</span></code> is a boolean array that describes this
neighborhood. Below, we use <code class="docutils literal notranslate"><span class="pre">disk</span></code> to create a circular structuring
element, which we use for most of the following examples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <a href="../../api/skimage.morphology.html#skimage.morphology.erosion" title="skimage.morphology.erosion" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">erosion</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.dilation" title="skimage.morphology.dilation" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">dilation</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.opening" title="skimage.morphology.opening" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">opening</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.closing" title="skimage.morphology.closing" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">closing</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.white_tophat" title="skimage.morphology.white_tophat" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">white_tophat</span></a>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <a href="../../api/skimage.morphology.html#skimage.morphology.black_tophat" title="skimage.morphology.black_tophat" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">black_tophat</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.skeletonize" title="skimage.morphology.skeletonize" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">skeletonize</span></a><span class="p">,</span> <a href="../../api/skimage.morphology.html#skimage.morphology.convex_hull_image" title="skimage.morphology.convex_hull_image" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">convex_hull_image</span></a>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <a href="../../api/skimage.morphology.html#skimage.morphology.disk" title="skimage.morphology.disk" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">disk</span></a>  <span class="c1"># noqa</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.disk" title="skimage.morphology.disk" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">disk</span></a><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eroded</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.erosion" title="skimage.morphology.erosion" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">erosion</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">eroded</span></a><span class="p">,</span> <span class="s1">&#39;erosion&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_002.png" srcset="../../_images/sphx_glr_plot_morphology_002.png" alt="original, erosion" class = "sphx-glr-single-img"/><p>Notice how the white boundary of the image disappears or gets eroded as we
increase the size of the disk. Also notice the increase in size of the two
black ellipses in the center and the disappearance of the 3 light gray
patches in the lower part of the image.</p>
</section>
<section id="dilation">
<h2>Dilation<a class="headerlink" href="#dilation" title="Link to this heading">#</a></h2>
<p>Morphological <code class="docutils literal notranslate"><span class="pre">dilation</span></code> sets a pixel at (i, j) to the <em>maximum over all
pixels in the neighborhood centered at (i, j)</em>. Dilation enlarges bright
regions and shrinks dark regions.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dilated</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.dilation" title="skimage.morphology.dilation" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">dilation</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dilated</span></a><span class="p">,</span> <span class="s1">&#39;dilation&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_003.png" srcset="../../_images/sphx_glr_plot_morphology_003.png" alt="original, dilation" class = "sphx-glr-single-img"/><p>Notice how the white boundary of the image thickens, or gets dilated, as we
increase the size of the disk. Also notice the decrease in size of the two
black ellipses in the center, and the thickening of the light gray circle
in the center and the 3 patches in the lower part of the image.</p>
</section>
<section id="opening">
<h2>Opening<a class="headerlink" href="#opening" title="Link to this heading">#</a></h2>
<p>Morphological <code class="docutils literal notranslate"><span class="pre">opening</span></code> on an image is defined as an <em>erosion followed by
a dilation</em>. Opening can remove small bright spots (i.e. “salt”) and
connect small dark cracks.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">opened</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.opening" title="skimage.morphology.opening" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">opening</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">opened</span></a><span class="p">,</span> <span class="s1">&#39;opening&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_004.png" srcset="../../_images/sphx_glr_plot_morphology_004.png" alt="original, opening" class = "sphx-glr-single-img"/><p>Since <code class="docutils literal notranslate"><span class="pre">opening</span></code> an image starts with an erosion operation, light regions
that are <em>smaller</em> than the structuring element are removed. The dilation
operation that follows ensures that light regions that are <em>larger</em> than
the structuring element retain their original size. Notice how the light
and dark shapes in the center retain their original thickness but the 3 lighter
patches in the bottom get completely eroded. The size dependence is
highlighted by the outer white ring: The parts of the ring thinner than the
structuring element are completely erased, while the thicker region at the
top retains its original thickness.</p>
</section>
<section id="closing">
<h2>Closing<a class="headerlink" href="#closing" title="Link to this heading">#</a></h2>
<p>Morphological <code class="docutils literal notranslate"><span class="pre">closing</span></code> on an image is defined as a <em>dilation followed by
an erosion</em>. Closing can remove small dark spots (i.e. “pepper”) and
connect small bright cracks.</p>
<p>To illustrate this more clearly, let’s add a small crack to the white
border:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span><span class="mi">210</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">closed</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.closing" title="skimage.morphology.closing" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">closing</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">closed</span></a><span class="p">,</span> <span class="s1">&#39;closing&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_005.png" srcset="../../_images/sphx_glr_plot_morphology_005.png" alt="original, closing" class = "sphx-glr-single-img"/><p>Since <code class="docutils literal notranslate"><span class="pre">closing</span></code> an image starts with a dilation operation, dark regions
that are <em>smaller</em> than the structuring element are removed. The dilation
operation that follows ensures that dark regions that are <em>larger</em> than the
structuring element retain their original size. Notice how the white
ellipses at the bottom get connected because of dilation, but other dark
regions retain their original sizes. Also notice how the crack we added is
mostly removed.</p>
</section>
<section id="white-tophat">
<h2>White tophat<a class="headerlink" href="#white-tophat" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">white_tophat</span></code> of an image is defined as the <em>image minus its
morphological opening</em>. This operation returns the bright spots of the
image that are smaller than the structuring element.</p>
<p>To make things interesting, we’ll add bright and dark spots to the image:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orig_phantom</span></a><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">[</span><span class="mi">340</span><span class="p">:</span><span class="mi">350</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span><span class="mi">210</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">110</span><span class="p">,</span> <span class="mi">200</span><span class="p">:</span><span class="mi">210</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">w_tophat</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.white_tophat" title="skimage.morphology.white_tophat" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">white_tophat</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">w_tophat</span></a><span class="p">,</span> <span class="s1">&#39;white tophat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_006.png" srcset="../../_images/sphx_glr_plot_morphology_006.png" alt="original, white tophat" class = "sphx-glr-single-img"/><p>As you can see, the 10-pixel wide white square is highlighted since it is
smaller than the structuring element. Also, the thin, white edges around
most of the ellipse are retained because they’re smaller than the
structuring element, but the thicker region at the top disappears.</p>
</section>
<section id="black-tophat">
<h2>Black tophat<a class="headerlink" href="#black-tophat" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">black_tophat</span></code> of an image is defined as its morphological <strong>closing
minus the original image</strong>. This operation returns the <em>dark spots of the
image that are smaller than the structuring element</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b_tophat</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.black_tophat" title="skimage.morphology.black_tophat" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">black_tophat</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">footprint</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phantom</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">b_tophat</span></a><span class="p">,</span> <span class="s1">&#39;black tophat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_007.png" srcset="../../_images/sphx_glr_plot_morphology_007.png" alt="original, black tophat" class = "sphx-glr-single-img"/><p>As you can see, the 10-pixel wide black square is highlighted since
it is smaller than the structuring element.</p>
<p><strong>Duality</strong></p>
<p>As you should have noticed, many of these operations are simply the reverse
of another operation. This duality can be summarized as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Erosion &lt;-&gt; Dilation</p></li>
<li><p>Opening &lt;-&gt; Closing</p></li>
<li><p>White tophat &lt;-&gt; Black tophat</p></li>
</ol>
</div></blockquote>
</section>
<section id="skeletonize">
<h2>Skeletonize<a class="headerlink" href="#skeletonize" title="Link to this heading">#</a></h2>
<p>Thinning is used to reduce each connected component in a binary image to a
<em>single-pixel wide skeleton</em>. It is important to note that this is
performed on binary images only.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a> <span class="o">=</span> <a href="../../api/skimage.data.html#skimage.data.horse" title="skimage.data.horse" class="sphx-glr-backref-module-skimage-data sphx-glr-backref-type-py-function"><span class="n">data</span><span class="o">.</span><span class="n">horse</span></a><span class="p">()</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sk</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.skeletonize" title="skimage.morphology.skeletonize" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">skeletonize</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sk</span></a><span class="p">,</span> <span class="s1">&#39;skeletonize&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_008.png" srcset="../../_images/sphx_glr_plot_morphology_008.png" alt="original, skeletonize" class = "sphx-glr-single-img"/><p>As the name suggests, this technique is used to thin the image to 1-pixel
wide skeleton by applying thinning successively.</p>
</section>
<section id="convex-hull">
<h2>Convex hull<a class="headerlink" href="#convex-hull" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">convex_hull_image</span></code> is the <em>set of pixels included in the smallest
convex polygon that surround all white pixels in the input image</em>. Again
note that this is also performed on binary images.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hull1</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.convex_hull_image" title="skimage.morphology.convex_hull_image" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">convex_hull_image</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hull1</span></a><span class="p">,</span> <span class="s1">&#39;convex hull&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_009.png" srcset="../../_images/sphx_glr_plot_morphology_009.png" alt="original, convex hull" class = "sphx-glr-single-img"/><p>As the figure illustrates, <code class="docutils literal notranslate"><span class="pre">convex_hull_image</span></code> gives the smallest polygon
which covers the white or True completely in the image.</p>
<p>If we add a small grain to the image, we can see how the convex hull adapts
to enclose that grain:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse_mask</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse</span></a> <span class="o">==</span> <span class="mi">0</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse_mask</span></a><span class="p">[</span><span class="mi">45</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hull2</span></a> <span class="o">=</span> <a href="../../api/skimage.morphology.html#skimage.morphology.convex_hull_image" title="skimage.morphology.convex_hull_image" class="sphx-glr-backref-module-skimage-morphology sphx-glr-backref-type-py-function"><span class="n">convex_hull_image</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse_mask</span></a><span class="p">)</span>
<span class="n">plot_comparison</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">horse_mask</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hull2</span></a><span class="p">,</span> <span class="s1">&#39;convex hull&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_morphology_010.png" srcset="../../_images/sphx_glr_plot_morphology_010.png" alt="original, convex hull" class = "sphx-glr-single-img"/></section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">#</a></h2>
<p>1. <a class="reference external" href="https://se.mathworks.com/help/images/morphological-dilation-and-erosion.html">MathWorks tutorial on morphological processing</a></p>
<p>2. <a class="reference external" href="https://www.cs.auckland.ac.nz/courses/compsci773s1c/lectures/ImageProcessing-html/topic4.htm">Auckland university’s tutorial on Morphological Image Processing</a></p>
<ol class="arabic simple" start="3">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p></li>
</ol>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 1.353 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-applications-plot-morphology-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-image/scikit-image/main?filepath=notebooks/auto_examples/applications/plot_morphology.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7692607b2cb8c87b1cc529af56520cbe/plot_morphology.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_morphology.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/db5bf5f616f4f7cd75ad3fb584d08c74/plot_morphology.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_morphology.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1cf66ebd5eab557e70103caf60e36dc8/plot_morphology.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_morphology.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#erosion">Erosion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dilation">Dilation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening">Opening</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closing">Closing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#white-tophat">White tophat</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-tophat">Black tophat</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skeletonize">Skeletonize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convex-hull">Convex hull</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/auto_examples/applications/plot_morphology.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2013-2024, the scikit-image team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>